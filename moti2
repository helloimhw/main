<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>몬티홀 게임 확률 실험</title>
<style>
body {
  font-family: "Pretendard", sans-serif;
  background: #f5f5ff;
  text-align: center;
  margin: 0; padding: 20px;
}
h1 {
  color: #333;
}
#game {
  margin-top: 40px;
}
.doors {
  display: flex;
  justify-content: center;
  gap: 30px;
}
.door {
  width: 120px;
  height: 200px;
  background: #ccc;
  border: 4px solid #555;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
}
.door:hover {
  transform: scale(1.05);
}
.open {
  background: #fffbea;
  cursor: default;
}
.car { color: #2196F3; }
.goat { color: #999; }
.button-group {
  margin-top: 20px;
}
button {
  padding: 8px 16px;
  border: none;
  border-radius: 5px;
  background: #2196F3;
  color: white;
  font-weight: bold;
  cursor: pointer;
  margin: 0 5px;
}
button:hover {
  background: #1976D2;
}
#result, #stats {
  margin-top: 30px;
  font-size: 1.2em;
}
.stats-box {
  background: white;
  border-radius: 8px;
  border: 2px solid #ddd;
  display: inline-block;
  padding: 15px 30px;
}
</style>
</head>
<body>
<h1>🚪 몬티홀 게임 확률 실험 🚗</h1>
<p>세 개의 문 중 하나를 선택하세요. 자동차는 한 문 뒤에 숨겨져 있고, 나머지는 염소입니다.</p>

<div id="game">
  <div class="doors">
    <div class="door" data-id="0">문 1</div>
    <div class="door" data-id="1">문 2</div>
    <div class="door" data-id="2">문 3</div>
  </div>
</div>

<div class="button-group" id="actions" style="display:none;">
  <button id="stay">유지하기 🚪</button>
  <button id="switch">바꾸기 🔄</button>
</div>

<div id="result"></div>
<div id="stats">
  <div class="stats-box">
    <p>유지 전략 - 승리: <span id="stayWin">0</span> / 시도: <span id="stayTotal">0</span> (확률 <span id="stayRate">0</span>%)</p>
    <p>변경 전략 - 승리: <span id="switchWin">0</span> / 시도: <span id="switchTotal">0</span> (확률 <span id="switchRate">0</span>%)</p>
  </div>
</div>

<script>
let doors = document.querySelectorAll('.door');
let actions = document.getElementById('actions');
let result = document.getElementById('result');

let carDoor, playerChoice, openedDoor;

// 통계
let stayWin = 0, stayTotal = 0, switchWin = 0, switchTotal = 0;

resetGame();

doors.forEach(door => {
  door.addEventListener('click', () => {
    if (playerChoice !== null) return;
    playerChoice = parseInt(door.dataset.id);
    door.style.background = "#FFD54F";
    openGoatDoor();
    actions.style.display = "block";
  });
});

document.getElementById('stay').addEventListener('click', () => {
  revealResult("stay");
});

document.getElementById('switch').addEventListener('click', () => {
  revealResult("switch");
});

function resetGame() {
  carDoor = Math.floor(Math.random() * 3);
  playerChoice = null;
  openedDoor = null;
  actions.style.display = "none";
  result.textContent = "";
  doors.forEach((d, i) => {
    d.className = 'door';
    d.textContent = `문 ${i+1}`;
    d.style.background = "#ccc";
  });
}

function openGoatDoor() {
  // 플레이어가 고르지 않은 문 중 염소가 있는 문 하나를 엶
  let possible = [0,1,2].filter(i => i !== playerChoice && i !== carDoor);
  openedDoor = possible[Math.floor(Math.random() * possible.length)];
  
  let doorEl = doors[openedDoor];
  doorEl.classList.add("open");
  doorEl.textContent = "🐐 염소!";
  doorEl.style.background = "#fffbea";
}

function revealResult(strategy) {
  let finalChoice;

  if (strategy === "stay") {
    finalChoice = playerChoice;
  } else {
    finalChoice = [0,1,2].find(i => i !== playerChoice && i !== openedDoor);
  }

  let win = (finalChoice === carDoor);

  // 문 열기
  doors.forEach((d,i)=>{
    d.classList.add('open');
    if (i === carDoor) {
      d.innerHTML = "🚗 자동차!";
      d.style.background = "#C8E6C9";
    } else if (i !== carDoor && i !== openedDoor) {
      d.innerHTML = "🐐 염소!";
      d.style.background = "#fffbea";
    }
  });

  if (strategy === "stay") {
    stayTotal++;
    if (win) stayWin++;
  } else {
    switchTotal++;
    if (win) switchWin++;
  }

  updateStats();

  result.innerHTML = win 
    ? `<p style="color:green;">🎉 승리! 자동차를 얻었습니다!</p>` 
    : `<p style="color:red;">😅 패배! 염소를 얻었습니다.</p>`;

  setTimeout(resetGame, 1800);
}

function updateStats(){
  let stayRate = stayTotal ? ((stayWin/stayTotal)*100).toFixed(1) : 0;
  let switchRate = switchTotal ? ((switchWin/switchTotal)*100).toFixed(1) : 0;

  document.getElementById("stayWin").textContent = stayWin;
  document.getElementById("stayTotal").textContent = stayTotal;
  document.getElementById("stayRate").textContent = stayRate;

  document.getElementById("switchWin").textContent = switchWin;
  document.getElementById("switchTotal").textContent = switchTotal;
  document.getElementById("switchRate").textContent = switchRate;
}
</script>
</body>
</html>
